<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cskaoyan.mapper.material.M_ConsumeMapper">
    
    <resultMap id="BaseResultMap" type="com.cskaoyan.domain.Material.Vo.MaterialConsumeVO">
        <id column="consume_id" property="consumeId" jdbcType="VARCHAR"/>
        <result column="consume_amount" property="consumeAmount" jdbcType="INTEGER"/>
        <result column="consume_date" property="consumeDate" jdbcType="TIMESTAMP"/>
        <result column="sender" property="sender" jdbcType="VARCHAR"/>
        <result column="receiver" property="receiver" jdbcType="VARCHAR"/>
        <result column="note" property="note" jdbcType="VARCHAR"/>
        <association property="work" javaType="com.cskaoyan.domain.yangtao.Work">
            <id column="work_id" property="workId" jdbcType="VARCHAR"/>
            <result column="process_number" property="processNumber" jdbcType="VARCHAR"/>
            <result column="product_id" property="productId" jdbcType="VARCHAR"/>
            <result column="process_id" property="processId" jdbcType="VARCHAR"/>
            <result column="equipment_id" property="equipmentId" jdbcType="VARCHAR"/>
            <result column="rating" property="rating" jdbcType="INTEGER"/>
        </association>
        <association property="material" javaType="com.cskaoyan.domain.Material.Material">
            <id column="material_id" property="materialId" jdbcType="VARCHAR"/>
            <result column="material_type" property="materialType" jdbcType="VARCHAR"/>
            <result column="status" property="status" jdbcType="VARCHAR"/>
            <result column="remaining" property="remaining" jdbcType="INTEGER"/>
            <result column="note" property="note" jdbcType="VARCHAR"/>
        </association>
    </resultMap>

    <select id="find" parameterType="com.cskaoyan.domain.Material.Vo.MaterialConsumeVO" resultMap="BaseResultMap">
   SELECT
			consume_id,
			consume_amount,
			consume_date,
			sender,
			receiver,
			material_consume.note,
			material.material_id,
			work.work_id
		FROM
			material_consume
		LEFT JOIN material ON material_consume.material_id = material.material_id
		LEFT JOIN work ON material_consume.work_id = work.work_id
	</select>

    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Dec 07 21:26:47 CST 2018.
        -->
        consume_id, work_id, material_id, consume_amount, consume_date, sender, receiver,
        note
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Dec 07 21:26:47 CST 2018.
        -->
        select
        <include refid="Base_Column_List"/>
        from material_consume
        where consume_id = #{consumeId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Dec 07 21:26:47 CST 2018.
        -->
        delete from material_consume
        where consume_id = #{consumeId,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.cskaoyan.domain.Material.M_Consume">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Dec 07 21:26:47 CST 2018.
        -->
        insert into material_consume (consume_id, work_id, material_id,
        consume_amount, consume_date, sender,
        receiver, note)
        values (#{consumeId,jdbcType=VARCHAR}, #{workId,jdbcType=VARCHAR}, #{materialId,jdbcType=VARCHAR},
        #{consumeAmount,jdbcType=INTEGER}, #{consumeDate,jdbcType=TIMESTAMP}, #{sender,jdbcType=VARCHAR},
        #{receiver,jdbcType=VARCHAR}, #{note,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="com.cskaoyan.domain.Material.M_Consume">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Dec 07 21:26:47 CST 2018.
        -->
        insert into material_consume
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="consumeId != null">
                consume_id,
            </if>
            <if test="workId != null">
                work_id,
            </if>
            <if test="materialId != null">
                material_id,
            </if>
            <if test="consumeAmount != null">
                consume_amount,
            </if>
            <if test="consumeDate != null">
                consume_date,
            </if>
            <if test="sender != null">
                sender,
            </if>
            <if test="receiver != null">
                receiver,
            </if>
            <if test="note != null">
                note,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="consumeId != null">
                #{consumeId,jdbcType=VARCHAR},
            </if>
            <if test="workId != null">
                #{workId,jdbcType=VARCHAR},
            </if>
            <if test="materialId != null">
                #{materialId,jdbcType=VARCHAR},
            </if>
            <if test="consumeAmount != null">
                #{consumeAmount,jdbcType=INTEGER},
            </if>
            <if test="consumeDate != null">
                #{consumeDate,jdbcType=TIMESTAMP},
            </if>
            <if test="sender != null">
                #{sender,jdbcType=VARCHAR},
            </if>
            <if test="receiver != null">
                #{receiver,jdbcType=VARCHAR},
            </if>
            <if test="note != null">
                #{note,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.cskaoyan.domain.Material.M_Consume">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Dec 07 21:26:47 CST 2018.
        -->
        update material_consume
        <set>
            <if test="workId != null">
                work_id = #{workId,jdbcType=VARCHAR},
            </if>
            <if test="materialId != null">
                material_id = #{materialId,jdbcType=VARCHAR},
            </if>
            <if test="consumeAmount != null">
                consume_amount = #{consumeAmount,jdbcType=INTEGER},
            </if>
            <if test="consumeDate != null">
                consume_date = #{consumeDate,jdbcType=TIMESTAMP},
            </if>
            <if test="sender != null">
                sender = #{sender,jdbcType=VARCHAR},
            </if>
            <if test="receiver != null">
                receiver = #{receiver,jdbcType=VARCHAR},
            </if>
            <if test="note != null">
                note = #{note,jdbcType=VARCHAR},
            </if>
        </set>
        where consume_id = #{consumeId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.cskaoyan.domain.Material.M_Consume">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Dec 07 21:26:47 CST 2018.
        -->
        update material_consume
        set work_id = #{workId,jdbcType=VARCHAR},
        material_id = #{materialId,jdbcType=VARCHAR},
        consume_amount = #{consumeAmount,jdbcType=INTEGER},
        consume_date = #{consumeDate,jdbcType=TIMESTAMP},
        sender = #{sender,jdbcType=VARCHAR},
        receiver = #{receiver,jdbcType=VARCHAR},
        note = #{note,jdbcType=VARCHAR}
        where consume_id = #{consumeId,jdbcType=VARCHAR}
    </update>
    <!-- 依据consumeID查询 -->
    <select id="searchMaterialConsumeByConsumeId" parameterType="string" resultMap="BaseResultMap">
		SELECT
			consume_id,
			consume_amount,
			consume_date,
			sender,
			receiver,
			material_consume.note,
			material.material_id,
			work.work_id
		FROM
			material_consume
		LEFT JOIN  material
			ON	 material_consume.material_id=material.material_id
		LEFT JOIN  work
		    ON   material_consume.work_id=work.work_id
		WHERE  consume_id like CONCAT('%',#{consumeId},'%' )

	</select>
     <select id="searchMaterialConsumeByMaterialId" parameterType="string" resultMap="BaseResultMap">
		SELECT
			consume_id,
			consume_amount,
			consume_date,
			sender,
			receiver,
			material_consume.note,
			material.material_id,
			work.work_id
		FROM
			material_consume
		LEFT JOIN  material
			ON	 material_consume.material_id=material.material_id
		LEFT JOIN  work
		    ON   material_consume.work_id=work.work_id
		  where  material_consume.material_id like CONCAT('%',#{materialId},'%' )
	  </select>
    <!-- 依据workID查询 -->
    <select id="searchMaterialConsumeByWorkId" parameterType="string" resultMap="BaseResultMap">
	SELECT
				consume_id,
				consume_amount,
				consume_date,
				sender,
				receiver,
				material_consume.note,
				material.material_id,
				work.work_id
		FROM
				material_consume
			LEFT JOIN  material
				ON	 material_consume.material_id=material.material_id
			LEFT JOIN  work
			    ON   material_consume.work_id=work.work_id
			WHERE material_consume.work_id like CONCAT('%',#{workId},'%' )
   	</select>
</mapper>